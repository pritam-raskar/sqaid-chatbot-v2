# Database Schema Configuration
# Define tables with semantic descriptions for LLM understanding

databases:
  # ========================================================================
  # ORACLE DATABASE
  # ========================================================================
  oracle:
    connection_env_vars:
      host: "ORACLE_HOST"
      port: "ORACLE_PORT"
      service_name: "ORACLE_SERVICE_NAME"
      user: "ORACLE_USER"
      password: "ORACLE_PASSWORD"

    # Default schema for Oracle (optional - if not specified, uses default schema for the user)
    default_schema: "SECURITY"

    tables:
      - name: "alert_positions"
        schema: "SECURITY"  # Oracle schema name
        description: "Geographic positions and locations of security alerts, including latitude, longitude, and timestamp. Use this when user asks about alert locations, coordinates, positions, or where alerts occurred."
        keywords: ["position", "location", "coordinates", "latitude", "longitude", "alert location", "geography", "where"]
        primary_key: "alert_id"
        searchable_columns: ["alert_id", "lat", "lon", "timestamp"]
        common_joins:
          - table: "alerts"
            schema: "SECURITY"
            join_on: "alert_id"
            description: "Join with alerts table to get alert details"

      - name: "incidents"
        schema: "SECURITY"
        description: "Security incidents, events, breaches, violations, and security-related occurrences. Use this when user asks about security incidents, breaches, events, or violations."
        keywords: ["incident", "event", "breach", "security", "violation", "occurrence"]
        primary_key: "incident_id"
        searchable_columns: ["incident_id", "type", "severity", "status", "created_at"]

      - name: "audit_logs"
        schema: "AUDIT"  # Different schema for audit data
        description: "System audit logs, activity history, user actions, and system events for compliance and tracking. Use this when user asks about audit trail, user activity, system logs, or compliance records."
        keywords: ["audit", "log", "activity", "history", "tracking", "compliance"]
        primary_key: "log_id"
        searchable_columns: ["log_id", "user_id", "action", "timestamp"]

  # ========================================================================
  # POSTGRESQL DATABASE
  # ========================================================================
  postgresql:
    connection_env_vars:
      host: "POSTGRES_HOST"
      port: "POSTGRES_PORT"
      database: "POSTGRES_DB"
      user: "POSTGRES_USER"
      password: "POSTGRES_PASSWORD"

    # Default schema for PostgreSQL (defaults to 'public' if not specified)
    default_schema: "public"

    tables:
      - name: "cm_alerts"
        schema: "info_alert"
        description: "Alert records, system notifications, incident alerts, warning messages, and triggered events. This table stores all alert instances generated by the system including their status, severity, timestamps, and associated metadata. Use this when user asks about alerts, notifications, warnings, incidents, triggered events, alert history, or active alerts."
        keywords: ["alert", "notification", "warning", "incident", "event", "trigger", "alarm", "message", "severity", "emergency"]
        primary_key: "id"
        searchable_columns: ["id", "alert_id", "alert_type_id", "status", "priority", "total_score", "focal_entity", "owner_id", "owner_name", "business_date", "created_at", "updated_at"]
        common_joins:
          - table: "cm_alert_type"
            schema: "info_alert"
            join_on: "alert_type_id = alert_type_id"
            description: "Join with alert types to get alert category and type information"
          - table: "cm_users"
            schema: "info_alert"
            join_on: "owner_id = user_id"
            description: "Join with users to get alert owner information"
        column_metadata:
          id:
            type: "bigint"
            description: "Unique sequential identifier for the alert record"
            nullable: false
          alert_id:
            type: "varchar"
            max_length: 255
            description: "Business identifier for the alert"
            nullable: false
          create_date:
            type: "timestamp"
            description: "Timestamp when the alert was originally created"
            nullable: false
          last_update_date:
            type: "timestamp"
            description: "Timestamp of the most recent update to the alert"
            nullable: false
          total_score:
            type: "numeric"
            range: [0, 1000]
            description: "Calculated alert risk score based on severity, frequency, and impact. Typical values range from 63-97 in production data."
            nullable: false
          business_date:
            type: "timestamp"
            description: "Business date associated with the alert event"
            nullable: false
          focal_entity:
            type: "varchar"
            max_length: 255
            description: "Primary entity or subject that the alert is focused on"
            nullable: false
          focus:
            type: "varchar"
            max_length: 255
            description: "Specific focus or area of concern for the alert"
            nullable: false
          alert_type_id:
            type: "varchar"
            max_length: 255
            description: "Foreign key reference to alert type definition"
            nullable: false
          alert_region:
            type: "varchar"
            max_length: 255
            description: "Geographic or business region where the alert originated"
            nullable: false
          alert_group_id:
            type: "varchar"
            max_length: 255
            description: "Identifier for grouping related alerts together"
            nullable: false
          is_consolidated:
            type: "boolean"
            description: "Indicates if this alert has been consolidated with other alerts"
            nullable: false
          is_active:
            type: "boolean"
            description: "Indicates if the alert is currently active in the system"
            nullable: false
          has_multiple_scenario:
            type: "boolean"
            description: "Indicates if the alert involves multiple scenarios or conditions"
            nullable: false
          is_deleted:
            type: "boolean"
            description: "Soft delete flag - indicates if the alert has been marked as deleted"
            nullable: false
          org_id:
            type: "varchar"
            max_length: 255
            description: "Organization identifier associated with the alert"
            nullable: false
          org_family:
            type: "varchar"
            max_length: 255
            description: "Organization family or hierarchy classification"
            nullable: false
          previous_org_unit_id:
            type: "varchar"
            max_length: 255
            description: "Previous organizational unit ID before any transfer or update"
            nullable: false
          is_org_unit_updated:
            type: "boolean"
            description: "Indicates if the organizational unit assignment has been updated"
            nullable: false
          is_related_alert:
            type: "boolean"
            description: "Indicates if this alert is related to or linked with other alerts"
            nullable: false
          owner_id:
            type: "varchar"
            max_length: 255
            description: "User ID of the alert owner or person responsible"
            nullable: false
          owner_name:
            type: "varchar"
            max_length: 255
            description: "Full name of the alert owner"
            nullable: false
          status:
            type: "varchar"
            max_length: 255
            possible_values: ["Open", "Closed"]
            case_sensitive: false
            description: "Current status of the alert. Common values include Open and Closed."
            nullable: false
          alert_step_id:
            type: "varchar"
            max_length: 255
            description: "Identifier for the current workflow step of the alert"
            nullable: false
          alert_step_name:
            type: "varchar"
            max_length: 255
            description: "Name of the current workflow step"
            nullable: false
          is_case_created:
            type: "boolean"
            description: "Indicates if a case has been created from this alert"
            nullable: false
          details:
            type: "text"
            description: "Detailed information and context about the alert"
            nullable: false
          created_at:
            type: "timestamp"
            description: "System timestamp when the record was created"
            nullable: true
          updated_at:
            type: "timestamp"
            description: "System timestamp when the record was last updated"
            nullable: true
          pivot:
            type: "varchar"
            max_length: 255
            description: "Pivot or key dimension for alert analysis"
            nullable: true
          account_id:
            type: "varchar"
            max_length: 255
            description: "Account identifier associated with the alert"
            nullable: true
          transaction_id:
            type: "varchar"
            max_length: 255
            description: "Transaction identifier that triggered or is related to the alert"
            nullable: true
          customer_id:
            type: "varchar"
            max_length: 255
            description: "Customer identifier associated with the alert"
            nullable: true
          household_id:
            type: "varchar"
            max_length: 255
            description: "Household identifier for customer grouping"
            nullable: true
          priority:
            type: "varchar"
            max_length: 255
            possible_values: ["Critical", "High", "Medium", "Low"]
            case_sensitive: false
            description: "Alert priority level indicating urgency. Common values: Critical, High, Medium."
            nullable: true
          tag:
            type: "varchar"
            max_length: 255
            description: "Tags or labels for categorizing and filtering alerts"
            nullable: true
          branch_id:
            type: "varchar"
            max_length: 255
            description: "Branch or location identifier where the alert originated"
            nullable: true
          representative_id:
            type: "varchar"
            max_length: 255
            description: "Representative or agent identifier associated with the alert"
            nullable: true
          building_block:
            type: "varchar"
            max_length: 255
            description: "Building block or module that generated the alert"
            nullable: true
          watch_list_id:
            type: "varchar"
            max_length: 255
            description: "Watch list identifier if alert is related to monitored entities"
            nullable: true
          created_by:
            type: "varchar"
            description: "User ID of the person who created or triggered the alert"
            nullable: true
          reason_details:
            type: "text"
            description: "Detailed reasons or rationale for the alert"
            nullable: true
          representative_name:
            type: "varchar"
            description: "Name of the representative or agent"
            nullable: true
          last_step_updated_date:
            type: "date"
            description: "Date when the workflow step was last updated"
            nullable: true
          due_in:
            type: "varchar"
            description: "Time remaining until the alert is due (e.g., '2 days', '4 hours')"
            nullable: true
          deadline:
            type: "date"
            description: "Deadline date for addressing the alert"
            nullable: true
          org_key:
            type: "varchar"
            description: "Organizational unit key for classification"
            nullable: true
          branch_name:
            type: "varchar"
            description: "Name of the branch or location"
            nullable: true
          customer_name:
            type: "varchar"
            description: "Name of the customer associated with the alert"
            nullable: true
          account_name:
            type: "varchar"
            description: "Name or description of the account"
            nullable: true
          scenario_model_ids:
            type: "varchar"
            max_length: 255
            description: "Comma-separated list of scenario model identifiers"
            nullable: true
          scenario_model_names:
            type: "varchar"
            max_length: 255
            description: "Comma-separated list of scenario model names"
            nullable: true
          alert_type_name:
            type: "varchar"
            max_length: 255
            description: "Human-readable name of the alert type"
            nullable: true
          custom_fields:
            type: "jsonb"
            description: "JSON object containing custom field values specific to the alert"
            nullable: true

      - name: "cm_case"
        schema: "info_alert"
        description: "Case management records, support tickets, issue tracking, problem reports, service requests, and incident cases. This table contains all case lifecycle information including status, priority, assignments, resolution details, and case history. Use this when user asks about cases, tickets, issues, problems, support requests, case status, open cases, resolved cases, case assignments, or case history."
        keywords: ["case", "ticket", "issue", "problem", "support", "request", "incident", "service request", "bug", "task", "work item", "assignment"]
        primary_key: "case_id"
        searchable_columns: ["case_id", "case_number", "title", "status", "priority", "case_type", "owner_id", "owner_name", "created_by", "created_at", "updated_at", "closed_at"]
        common_joins:
          - table: "cm_users"
            schema: "info_alert"
            join_on: "owner_id = user_id"
            description: "Join with users to get case owner details"
          - table: "cm_users"
            schema: "info_alert"
            join_on: "created_by = user_id"
            description: "Join with users to get case creator information"
          - table: "cm_workflow"
            schema: "info_alert"
            join_on: "workflow_id = workflow_id"
            description: "Join with workflow to get workflow definition"
          - table: "cm_workflow_step"
            schema: "info_alert"
            join_on: "current_step_id = step_id"
            description: "Join with workflow step to get current step details"
        column_metadata:
          case_id:
            type: "bigint"
            description: "Unique sequential identifier for the case"
            nullable: false
          case_number:
            type: "varchar"
            max_length: 50
            description: "Human-readable unique case number or ticket number"
            nullable: false
          title:
            type: "varchar"
            max_length: 255
            description: "Case title or summary"
            nullable: false
          description:
            type: "text"
            description: "Detailed case description, problem statement, or issue details"
            nullable: true
          status:
            type: "varchar"
            max_length: 50
            possible_values: ["New", "Open"]
            case_sensitive: false
            description: "Current status of the case in its lifecycle. Common values include New and Open."
            nullable: false
          priority:
            type: "varchar"
            max_length: 50
            possible_values: ["LOW", "MEDIUM", "HIGH", "CRITICAL"]
            case_sensitive: false
            description: "Case priority indicating urgency of resolution. Values: LOW, MEDIUM, HIGH, CRITICAL"
            nullable: true
          case_type:
            type: "varchar"
            max_length: 100
            description: "Type or category of the case (e.g., Technical, Business, Compliance)"
            nullable: true
          org_unit_id:
            type: "varchar"
            max_length: 100
            description: "Organizational unit identifier where the case belongs"
            nullable: true
          org_family:
            type: "varchar"
            max_length: 100
            description: "Organization family or hierarchy classification"
            nullable: true
          owner_id:
            type: "varchar"
            max_length: 100
            description: "User ID of the case owner or person assigned to resolve the case"
            nullable: true
          owner_name:
            type: "varchar"
            max_length: 255
            description: "Full name of the case owner"
            nullable: true
          workflow_id:
            type: "bigint"
            description: "Foreign key reference to the workflow definition"
            nullable: true
          current_step_id:
            type: "bigint"
            description: "Foreign key reference to the current workflow step"
            nullable: true
          current_step_name:
            type: "varchar"
            max_length: 255
            description: "Name of the current workflow step"
            nullable: true
          due_date:
            type: "timestamp"
            description: "Expected resolution or completion date"
            nullable: true
          resolution:
            type: "text"
            description: "Description of how the case was resolved"
            nullable: true
          created_by:
            type: "varchar"
            max_length: 100
            description: "User ID of the person who created the case"
            nullable: false
          created_at:
            type: "timestamp"
            description: "Timestamp when the case was created"
            nullable: false
          updated_at:
            type: "timestamp"
            description: "Timestamp of the last update to the case"
            nullable: false
          closed_at:
            type: "timestamp"
            description: "Timestamp when the case was closed"
            nullable: true
          is_active:
            type: "boolean"
            description: "Indicates if the case is currently active"
            nullable: false
          org_unit_key:
            type: "varchar"
            max_length: 255
            description: "Organizational unit key for classification"
            nullable: true
          previous_org_unit_id:
            type: "varchar"
            max_length: 255
            description: "Previous organizational unit ID before any transfer"
            nullable: true
          is_org_unit_updated:
            type: "boolean"
            description: "Indicates if the organizational unit assignment has been updated"
            nullable: true
          org_key:
            type: "varchar"
            max_length: 255
            description: "Organization key identifier"
            nullable: true
          total_score:
            type: "double precision"
            range: [0, null]
            description: "Calculated case risk or priority score. Must be >= 0."
            nullable: true
          business_region:
            type: "varchar"
            max_length: 255
            description: "Business region or geographic area associated with the case"
            nullable: true
          case_group_id:
            type: "varchar"
            max_length: 255
            description: "Identifier for grouping related cases together"
            nullable: true
          building_block:
            type: "varchar"
            max_length: 255
            description: "Building block or module that the case relates to"
            nullable: true
          is_deleted:
            type: "boolean"
            description: "Soft delete flag - indicates if the case has been marked as deleted"
            nullable: true
          is_consolidated:
            type: "boolean"
            description: "Indicates if this case has been consolidated with other cases"
            nullable: true
          is_related_case:
            type: "boolean"
            description: "Indicates if this case is related to or linked with other cases"
            nullable: true
          last_step_updated_date:
            type: "timestamp"
            description: "Date when the workflow step was last updated"
            nullable: true
          business_date:
            type: "timestamp"
            description: "Business date associated with the case"
            nullable: true
          deadline:
            type: "timestamp"
            description: "Deadline timestamp for case completion"
            nullable: true
          due_in:
            type: "varchar"
            max_length: 255
            description: "Time remaining until the case is due (e.g., '2 days', '4 hours')"
            nullable: true
          tag:
            type: "varchar"
            max_length: 255
            description: "Tags or labels for categorizing and filtering cases"
            nullable: true
          external_case_id:
            type: "varchar"
            max_length: 255
            description: "External system case identifier for integration purposes"
            nullable: true
          customer_id:
            type: "varchar"
            max_length: 255
            description: "Customer identifier associated with the case"
            nullable: true
          customer_name:
            type: "varchar"
            max_length: 255
            description: "Name of the customer"
            nullable: true
          account_id:
            type: "varchar"
            max_length: 255
            description: "Account identifier associated with the case"
            nullable: true
          account_name:
            type: "varchar"
            max_length: 255
            description: "Name or description of the account"
            nullable: true
          transaction_id:
            type: "varchar"
            max_length: 255
            description: "Transaction identifier related to the case"
            nullable: true
          household_id:
            type: "varchar"
            max_length: 255
            description: "Household identifier for customer grouping"
            nullable: true
          branch_id:
            type: "varchar"
            max_length: 255
            description: "Branch or location identifier"
            nullable: true
          branch_name:
            type: "varchar"
            max_length: 255
            description: "Name of the branch or location"
            nullable: true
          representative_id:
            type: "varchar"
            max_length: 255
            description: "Representative or agent identifier"
            nullable: true
          representative_name:
            type: "varchar"
            max_length: 255
            description: "Name of the representative or agent"
            nullable: true
          scenario_model_ids:
            type: "text"
            description: "Comma-separated list of scenario model identifiers"
            nullable: true
          scenario_model_names:
            type: "text"
            description: "Comma-separated list of scenario model names"
            nullable: true
          has_multiple_scenario:
            type: "boolean"
            description: "Indicates if the case involves multiple scenarios"
            nullable: true
          watch_list_id:
            type: "varchar"
            max_length: 255
            description: "Watch list identifier if case is related to monitored entities"
            nullable: true
          focal_entity:
            type: "varchar"
            max_length: 255
            description: "Primary entity or subject that the case is focused on"
            nullable: true
          focus:
            type: "text"
            description: "Specific focus or area of concern for the case"
            nullable: true
          pivot:
            type: "text"
            description: "Pivot or key dimension for case analysis"
            nullable: true
          custom_fields:
            type: "jsonb"
            description: "JSON object containing custom field values specific to the case"
            nullable: true
          workflow_info:
            type: "jsonb"
            description: "JSON object containing workflow-related metadata and state"
            nullable: true
          reason_details:
            type: "jsonb"
            description: "JSON object containing detailed reasons or rationale for case actions"
            nullable: true

      - name: "cm_alert_type"
        schema: "info_alert"
        description: "Alert type definitions, alert categories, alert classifications, and alert configuration templates. This lookup table defines different types of alerts in the system including their properties, default severity levels, escalation rules, and notification settings. Use this when user asks about alert types, alert categories, alert classifications, types of alerts available, alert configurations, or what kinds of alerts exist in the system."
        keywords: ["alert type", "alert category", "alert class", "type", "category", "classification", "alert definition", "alert config", "alert template"]
        primary_key: "aty_id"
        searchable_columns: ["aty_id", "alert_type_id", "type_name", "type_slug", "description", "is_active"]
        common_joins:
          - table: "cm_alerts"
            schema: "info_alert"
            join_on: "alert_type_id = alert_type_id"
            description: "Join with alerts to get all alerts of a specific type"
        column_metadata:
          aty_id:
            type: "integer"
            description: "Unique sequential identifier for the alert type record"
            nullable: false
          alert_type_id:
            type: "varchar"
            max_length: 255
            description: "Business identifier for the alert type (unique)"
            nullable: false
          created_at:
            type: "timestamp"
            description: "Timestamp when the alert type was created"
            nullable: false
          description:
            type: "text"
            description: "Detailed description of when this alert type is triggered and what it indicates"
            nullable: true
          type_name:
            type: "varchar"
            max_length: 255
            description: "Human-readable name of the alert type"
            nullable: false
          type_slug:
            type: "varchar"
            max_length: 255
            description: "URL-friendly slug or code for the alert type"
            nullable: false
          updated_at:
            type: "timestamp"
            description: "Timestamp of the last update to the alert type configuration"
            nullable: true
          is_active:
            type: "boolean"
            description: "Whether this alert type is currently active and can generate alerts"
            nullable: true

      - name: "cm_users"
        schema: "info_alert"
        description: "User accounts, system users, team members, employees, operators, administrators, and user profiles. This table stores all user information including authentication details, contact information, user preferences, and account status. Use this when user asks about users, people, team members, employees, operators, user accounts, user profiles, user information, who is assigned, contact details, or staff information."
        keywords: ["user", "person", "employee", "member", "account", "profile", "team", "people", "staff", "operator", "admin", "contact", "assignee"]
        primary_key: "user_id"
        searchable_columns: ["user_id", "user_login_name", "email", "user_first_name", "user_last_name", "user_is_active"]
        common_joins:
          - table: "cm_case"
            schema: "info_alert"
            join_on: "user_id = owner_id"
            description: "Join with cases to get cases owned by user"
          - table: "cm_alerts"
            schema: "info_alert"
            join_on: "user_id = owner_id"
            description: "Join with alerts to get alerts owned by user"
          - table: "cm_user_roles_mapping"
            schema: "info_alert"
            join_on: "user_id = user_id"
            description: "Join with user roles mapping to get user's role assignments"
        column_metadata:
          user_login_name:
            type: "varchar"
            max_length: 255
            description: "Username for login authentication"
            nullable: true
          user_login_password:
            type: "varchar"
            max_length: 255
            description: "Hashed password for user authentication"
            nullable: true
          user_first_name:
            type: "varchar"
            max_length: 50
            description: "User's first name"
            nullable: true
          user_middle_name:
            type: "varchar"
            max_length: 255
            description: "User's middle name"
            nullable: true
          user_last_name:
            type: "varchar"
            max_length: 255
            description: "User's last name"
            nullable: true
          user_is_active:
            type: "boolean"
            description: "Whether the user account is currently active"
            nullable: true
          email:
            type: "varchar"
            max_length: 100
            description: "User's email address"
            nullable: true
          user_id:
            type: "varchar"
            max_length: 255
            description: "Unique identifier for the user"
            nullable: false

      - name: "cm_user_roles_mapping"
        schema: "info_alert"
        description: "User-role relationship mapping, role assignments, user permissions mapping, and access control associations. This junction table manages the many-to-many relationship between users and roles, allowing users to have multiple roles and roles to be assigned to multiple users. Use this when user asks about user roles, role assignments, who has what role, user permissions, access levels, role membership, or user-role relationships."
        keywords: ["user role", "role mapping", "role assignment", "permission", "access", "user access", "role membership", "authorization", "user permission"]
        primary_key: "user_role_map_id"
        searchable_columns: ["user_role_map_id", "user_id", "role_id", "org_id"]
        common_joins:
          - table: "cm_users"
            schema: "info_alert"
            join_on: "user_id = user_id"
            description: "Join with users to get user details for role assignments"
          - table: "cm_roles"
            schema: "info_alert"
            join_on: "role_id = role_id"
            description: "Join with roles to get role details and permissions"
        column_metadata:
          user_id:
            type: "varchar"
            max_length: 255
            description: "Foreign key reference to the user"
            nullable: true
          role_id:
            type: "integer"
            description: "Foreign key reference to the role"
            nullable: true
          org_id:
            type: "integer"
            description: "Organization identifier for organization-specific role assignment"
            nullable: true
          user_role_map_id:
            type: "integer"
            description: "Unique identifier for the user-role mapping record"
            nullable: false

      - name: "cm_roles"
        schema: "info_alert"
        description: "Role definitions, user roles, permission groups, access levels, and security roles. This table defines all available roles in the system including their permissions, access rights, responsibilities, and role hierarchy. Use this when user asks about roles, permissions, access levels, user types, role definitions, what roles exist, role permissions, or security groups."
        keywords: ["role", "permission", "access level", "user role", "security role", "access rights", "privileges", "authorization", "admin", "operator", "viewer"]
        primary_key: "role_id"
        searchable_columns: ["role_id", "role_identifier", "role_name", "description"]
        common_joins:
          - table: "cm_user_roles_mapping"
            schema: "info_alert"
            join_on: "role_id = role_id"
            description: "Join with user roles mapping to get users assigned to this role"
        column_metadata:
          role_name:
            type: "varchar"
            max_length: 50
            description: "Human-readable name of the role"
            nullable: true
          description:
            type: "varchar"
            description: "Detailed description of the role's responsibilities and access rights"
            nullable: true
          role_id:
            type: "integer"
            description: "Unique sequential identifier for the role"
            nullable: false
          role_identifier:
            type: "varchar"
            max_length: 255
            description: "Unique code or identifier for the role (unique)"
            nullable: false

# Global Database Settings
query_timeout: 30
max_results_default: 100
enable_query_logging: true
